* Script for git management

** Source the functions script
#+begin_src sh :shebang #!/bin/sh :results output :mkdirp yes :tangle ./.git.sh
  . "${HOME}/important_functions.sh"
#+end_src

** Add files to git
#+begin_src sh :shebang #!/bin/sh :results output :mkdirp yes :tangle ./.git.sh
  GITADD 'Cargo.toml'
  GITADD '.gitignore'
  GITADD 'main.org'
  GITADD 'run_cpu.sh'
  GITADD 'src/deb_mirror.rs'
  GITADD 'src/download_dist.rs'
  GITADD 'src/mysync.rs'
  GITADD 'src/parallel_run.rs'
  GITADD 'template.org'
#+end_src

** Remove files
#+begin_src sh :shebang #!/bin/sh :results output :mkdirp yes :tangle ./.git.sh
  CLEAN '.Cargo.toml.~undo-tree~'
  CLEAN '.git.sh'
  CLEAN '#main.org#'
  CLEAN '.#main.org'
  CLEAN 'main.org~'
  CLEAN '.main.org.~undo-tree~'
  CLEAN '.README.org.~undo-tree~'
  CLEAN 'src/.download_dist.rs.~undo-tree~'
  CLEAN 'src/mysync.rs~'
  CLEAN 'src/.mysync.rs.~undo-tree~'
  CLEAN 'src/#parallel_run.rs#'
  CLEAN 'src/.parallel_run.rs.~undo-tree~'
#+end_src

* Script to run the docker image
#+begin_src sh :shebang #!/bin/sh :results output :mkdirp yes :tangle ./run_cpu.sh
  cd "$('dirname' '--' "${0}")"
  podman run \
      -it --rm \
      '--device' '/dev/dri' \
      '--net' 'host' \
      '--security-opt' 'seccomp=unconfined' \
      --mount 'type=tmpfs,destination=/data/TMPFS,tmpfs-size=137438953472' \
      -v "$(realpath .):/data/source" \
      -v "${HOME}/BUILD:/data/build" \
      -v "CACHE:/usr/local/cargo/registry" \
      -v "CACHE:/root/.cache" \
      '6_pytorch' zsh \
  ;
#+end_src

* Files to ignore:
#+begin_src conf :tangle .gitignore
	Cargo.lock
	/target
#+end_src

* COMMENT Work space
#+begin_src emacs-lisp :results silent
  (save-buffer)
  (org-babel-tangle)
  (async-shell-command "
      './.git.sh'
      'git' 'status'
  " "log" "err")
#+end_src
